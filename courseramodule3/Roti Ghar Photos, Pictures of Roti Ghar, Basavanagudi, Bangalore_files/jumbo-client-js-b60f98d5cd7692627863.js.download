(window.__LOADABLE_LOADED_CHUNKS__=window.__LOADABLE_LOADED_CHUNKS__||[]).push([[96],{BVju:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o=n("qepT");t.default=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.hydrateMemoryFromLocalStorage=function(){try{if((0,o.isLocalStorageSupported)()){var e=window.localStorage.getItem("__jumbo__"),t="";e&&(t=JSON.parse(e),(0,o.isArray)(t)&&(window.jumbo=t.concat(window.jumbo?window.jumbo:[]))),window.localStorage.removeItem("__jumbo__")}}catch(e){(0,o.ravenLog)("Jumbo Error - hydrateMemoryFromLocalStorage - "+e)}},this.getEventsArr=function(){return(0,o.isArray)(window.jumbo)?window.jumbo.slice(0):[]},this.addEventsArr=function(e){(0,o.isArray)(e)&&(window.jumbo=((0,o.isArray)(window.jumbo)?window.jumbo:[]).concat(e))},this.saveEventsArr=function(e){(0,o.isLocalStorageSupported)()&&window.localStorage.setItem("__jumbo__",JSON.stringify(e))},this.clear=function(){window.jumbo=[]},this.hydrateMemoryFromLocalStorage()}},OzYo:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o,r=(o=n("GBY4"))&&o.__esModule?o:{default:o};var a=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=new r.default(e,!0),o={},a=null,i=null,u=null,s={zpwa:!0};t.method&&"GET"!==t.method.toUpperCase()?(t.body&&(i={body:t.body}),u={method:t.method}):(t.body&&(a=t.body),u={method:"GET"}),a=Object.assign({},n.query,a),t.headers&&(o=Object.assign({},t.headers,o)),t.no_zpwa||(a=Object.assign({},a,s));var d=Object.assign({},{credentials:"same-origin"},u,{headers:o},t.extras,i);return n.set("query",a),fetch(n.toString(),d).then(checkStatus)};t.default=a},qepT:function(t,n,o){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.sendViaFetchV2=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},o=d(t),r={no_zpwa:!0,method:"POST",body:JSON.stringify({app_payload:e}),extras:{credentials:"include"},headers:c(n)};return(0,a.default)(o,r).then((function(e){return e}))},n.convertToArray=n.isLocalStorageSupported=n.isObject=n.isArray=n.ravenLog=n.sendViaBeaconV2=n.getJumboUrl=n.formatJumboEvents=n.isBeaconSupported=n.addMultipleListners=void 0;var r=i(o("GBY4")),a=i(o("OzYo"));function i(e){return e&&e.__esModule?e:{default:e}}var u="https://jumbo.zomato.com/event";n.addMultipleListners=function(e,t,n){t.forEach((function(t){return e.addEventListener(t,n,!1)}))};var s=function(){return!(!window.navigator||"function"!=typeof window.navigator.sendBeacon)};n.isBeaconSupported=s;n.formatJumboEvents=function(e){return e.map((function(e){return{header:e.header,payload:e.payload}}))};var d=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=new r.default(u,!0);if(void 0!==e&&""!=e){var n=Object.assign({},t.query,{user_id:e});t.set("query",n)}return t.toString()};n.getJumboUrl=d;n.sendViaBeaconV2=function(e,t){var n=d(t);return s()&&navigator.sendBeacon(n,JSON.stringify({app_payload:e}))};var c=function(e){return{}};n.ravenLog=function(t){window&&window._Raven&&window._Raven.captureException&&window._Raven.captureException(new Error(t+" "+e.message))};var l=function(e){return Array.isArray(e)};n.isArray=l;var f=function(e){return e===Object(e)};n.isObject=f;n.isLocalStorageSupported=function(){return!!window.localStorage};n.convertToArray=function(e){var t=[];return l(e)?t=e:(f(e)||"string"==typeof e)&&(t=[e]),t}},zqKt:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o,r=n("qepT"),a=(o=n("BVju"))&&o.__esModule?o:{default:o};var i=null,u=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.setParams=function(e){i.user_id=e.user_id||0,i.city_id=e.city_id||0},this.setupCrons=function(){i.jumbo_memory_flush_interval=setInterval(i.sendEventsToJumbo,2e3)},this.getCityId=function(){return i.city_id},this.getPacketHeader=function(){var e=Math.round((new Date).getTime()/1e3);return{location:i.getCityId(),timestamp:e}},this.preparePacket=function(e,t){t=(0,r.convertToArray)(t);var n=document.URL;return t.map((function(t){return{header:i.getPacketHeader(),payload:{key:e,value:t,url:n}}}))},this.sendToJumbo=function(e,t){i.preparePacket(e,t).map((function(e){window.jumbo.push(e)}))},this.sendPageView=function(e){i.sendToJumbo("pageview",e)},this.addEventListeners=function(){var e=["blur","beforeunload","unload","online"];e=e.filter((function(e){return window.hasOwnProperty("on"+e)})),(0,r.addMultipleListners)(window,e,i.sendEventsToJumbo)},this.getEventsData=function(){var e=i.storage.getEventsArr(),t={raw_events:null,processed_events:null};return(0,r.isArray)(e)&&e.length&&(t.raw_events=e,t.processed_events=(0,r.formatJumboEvents)(e),i.storage.clear()),t},this.lockRequest=function(){i.request_in_progress=!0},this.unlockRequest=function(){i.request_in_progress=!1},this.shouldSendRequest=function(){return!(!navigator.onLine||i.request_in_progress||void 0===i.user_id)},this.sendEventsToJumbo=function(){var e=i.getEventsData(),t=e.raw_events,n=void 0===t?[]:t,o=e.processed_events,a=void 0===o?[]:o;try{(0,r.isArray)(n)&&n.length&&i.shouldSendRequest()&&a&&(i.lockRequest(),(0,r.isBeaconSupported)()?((0,r.sendViaBeaconV2)(a,i.user_id),i.unlockRequest()):(0,r.sendViaFetchV2)(a,i.user_id).then((function(e){i.unlockRequest()})).catch((function(e){i.unlockRequest(),i.storage.addEventsArr(n)})))}catch(e){i.unlockRequest(),i.storage.addEventsArr(n),(0,r.ravenLog)("Jumbo Error - sendEventsToJumbo")}}};u.getInstance=function(){if(!i){window.jumbo=[];var e=new u;(i=e).request_in_progress=!1,i.storage=new a.default,i.setupCrons(),i.addEventListeners()}return i};var s=u;t.default=s}}]);
//# sourceMappingURL=jumbo-client-js-b60f98d5cd7692627863.js.map